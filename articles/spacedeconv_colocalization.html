<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spacedeconv">
<title>Colocalization • spacedeconv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Colocalization">
<meta property="og:description" content="spacedeconv">
<meta property="og:image" content="https://omnideconv.github.io/spacedeconv/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spacedeconv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/spacedeconv.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/spacedeconv_clustering.html">Clustering</a>
    <a class="dropdown-item" href="../articles/spacedeconv_colocalization.html">Colocalization</a>
    <a class="dropdown-item" href="../articles/spacedeconv_data.html">Data Input</a>
    <a class="dropdown-item" href="../articles/spacedeconv_example.html">Example</a>
    <a class="dropdown-item" href="../articles/spacedeconv_faq.html">FAQ</a>
    <a class="dropdown-item" href="../articles/spacedeconv_metacell.html">Metacell</a>
    <a class="dropdown-item" href="../articles/spacedeconv_visualization.html">spacedeconv Visualization</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Colocalization</h1>
            
      
      
      <div class="d-none name"><code>spacedeconv_colocalization.Rmd</code></div>
    </div>

    
    
<p>To introduce spacedeconvs celltype colocalization and distribution
analysis functions we will utilize a deconvolution result obtained from
internal sample data and the deconvolution method <code>EPIC</code>.
Note that EPIC requires unnormalized data and is building the signature
and deconvoluting in one step. Therefore only <code><a href="../reference/deconvolute.html">deconvolute()</a></code>
is called.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spacedeconv</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spatial_data_3"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess.html">preprocess</a></span><span class="op">(</span><span class="va">spatial_data_3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu">spacedeconv</span><span class="fu">::</span><span class="fu"><a href="../reference/normalize.html">normalize</a></span><span class="op">(</span><span class="va">spe</span>, method <span class="op">=</span> <span class="st">"cpm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deconv</span> <span class="op">&lt;-</span> <span class="fu">spacedeconv</span><span class="fu">::</span><span class="fu"><a href="../reference/deconvolute.html">deconvolute</a></span><span class="op">(</span></span>
<span>  <span class="va">spe</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"epic"</span>,</span>
<span>  assay_sp <span class="op">=</span> <span class="st">"cpm"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="available-colocalization-functions">Available colocalization functions<a class="anchor" aria-label="anchor" href="#available-colocalization-functions"></a>
</h2>
<ol style="list-style-type: decimal">
<li>‘cell_pair_localization()’ calculates colocalization and avoidance
of two celltypes based on a random distribution.</li>
<li>‘ripleys_k()’ calculates Ripley´s K statistic and outputs
corresponding graph</li>
</ol>
<div class="section level3">
<h3 id="cell_pair_localization">1. ‘cell_pair_localization()’<a class="anchor" aria-label="anchor" href="#cell_pair_localization"></a>
</h3>
<p>Calculates colocalization and avoidance statistics of two celltypes
of interest based on a random distribution. Internally, the presence or
absence of the celltypes is determined based on the antimode of the
celltype density distribution. Spotwise comparisons or groupwise
comparisons with increasing distances are possible. Thereby, distance =
0 corresponds to a spotwise approach, distance = 1 considers hexagonal
rings of spots around each spot and distance = 2 refers to two rings of
spots around each spot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spacedeconv</span><span class="fu">::</span><span class="fu"><a href="../reference/cell_pair_localization.html">cell_pair_localization</a></span><span class="op">(</span><span class="va">deconv</span>, method <span class="op">=</span> <span class="st">"epic"</span>, cell_type_1 <span class="op">=</span> <span class="st">"epic_NK.cell"</span>, cell_type_2 <span class="op">=</span> <span class="st">"epic_B.cell"</span>, density <span class="op">=</span> <span class="cn">TRUE</span>, distance <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Calculating Antimode cutoffs"</span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span></code></pre></div>
<p><img src="spacedeconv_colocalization_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="spacedeconv_colocalization_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt;       coloc.coloc           coloc_p   coloc_rand_mean coloc_ratio.coloc </span></span>
<span><span class="co">#&gt;      0.0000000000      0.1500000000      0.0001265823      0.0000000000 </span></span>
<span><span class="co">#&gt;       avoid.avoid           avoid_p   avoid_rand_mean avoid_ratio.avoid </span></span>
<span><span class="co">#&gt;      0.0109704641      0.0000000000      0.0108354430      1.0124610592</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="riples_k">2. ‘riples_k()’<a class="anchor" aria-label="anchor" href="#riples_k"></a>
</h3>
<p>Determines the spatial distribution of a celltype based on Ripley´s K
function. A matrix with presence or absence values for each celltype,
determined using the antimode of the celltype density distribution, is
internally taken as input.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spacedeconv</span><span class="fu">::</span><span class="fu"><a href="../reference/ripleys_k.html">ripleys_k</a></span><span class="op">(</span><span class="va">deconv</span>, method <span class="op">=</span> <span class="st">"epic"</span>, cell_type <span class="op">=</span> <span class="st">"epic_B.cell"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Calculating Antimode cutoffs"</span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span>
<span></span>
<span><span class="co">#&gt; Warning in locmodes(logscore, mod0 = 2, display = F): If the density function</span></span>
<span><span class="co">#&gt; has an unbounded support, artificial modes may have been created in the tails</span></span></code></pre></div>
<p><img src="spacedeconv_colocalization_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Constantin Zackl.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
